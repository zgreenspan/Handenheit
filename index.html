<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handenheit</title>
    <link rel="stylesheet" href="styles.css?v=58">
    <script>
        // Check authentication before loading page
        if (sessionStorage.getItem('handenheit_auth') !== 'true') {
            window.location.href = 'auth.html';
        }
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Handenheit</h1>
            <p class="subtitle">AI-Powered Internal Database Search</p>
        </header>

        <div class="tabs">
            <div class="tab-highlight"></div>
            <button class="tab-btn active" data-tab="view">View Attendees</button>
            <button class="tab-btn" data-tab="collect">Collect Data</button>
            <button class="tab-btn" data-tab="import">Import/Export</button>
        </div>

        <!-- Data Collection Tab -->
        <div class="tab-content" id="collect">
            <div class="collection-panel">
                <h2>Add Attendee Profile</h2>

                <!-- Collection Method Tabs -->
                <div class="collection-method-tabs">
                    <button class="method-tab active" data-method="linkedin">LinkedIn JSON</button>
                    <button class="method-tab" data-method="pdf">Resume PDF</button>
                </div>

                <!-- LinkedIn Method -->
                <div class="method-content active" id="linkedin-method">
                    <p class="instructions">
                        <strong>How to use:</strong><br>
                        1. Open the attendee's LinkedIn profile in a new tab<br>
                        2. Press F12 (or Cmd+Option+I on Mac) to open DevTools<br>
                        3. Go to the Console tab<br>
                        4. Paste the contents of <code>linkedin-extractor.js</code> and press Enter<br>
                        5. The data will be copied to your clipboard<br>
                        6. Return here and paste it in the text area below
                    </p>

                    <div class="form-group">
                        <label for="jsonInput">Paste LinkedIn Profile Data:</label>
                        <textarea id="jsonInput" placeholder='Paste the JSON data here...' rows="10"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="schoolInput">School/University (from Airtable):</label>
                        <input type="text" id="schoolInput" placeholder="e.g., Stanford University">
                    </div>

                    <div class="form-group">
                        <label for="imageInput">Profile Image URL (optional):</label>
                        <input type="text" id="imageInput" placeholder="Paste LinkedIn profile image URL here">
                        <small style="color: #86868B; display: block; margin-top: 4px;">If the extractor didn't capture the image, you can paste the image URL manually</small>
                    </div>

                    <div class="form-actions">
                        <button id="addProfileBtn" class="btn btn-primary">Add Profile to Database</button>
                        <button id="clearFormBtn" class="btn btn-secondary">Clear Form</button>
                    </div>
                </div>

                <!-- PDF Method -->
                <div class="method-content" id="pdf-method">
                    <p class="instructions">
                        <strong>How to use:</strong><br>
                        Upload a resume PDF and we'll use AI to extract the profile data automatically.
                    </p>

                    <div class="form-group">
                        <label for="pdfInput">Upload Resume PDF:</label>
                        <div class="pdf-upload-area" id="pdfUploadArea">
                            <input type="file" id="pdfInput" accept=".pdf" style="display: none;">
                            <div class="upload-placeholder">
                                <span class="upload-icon">üìÑ</span>
                                <span>Click to select PDF or drag and drop</span>
                                <span class="upload-hint">Maximum file size: 10MB</span>
                            </div>
                            <div class="upload-preview" style="display: none;">
                                <span class="file-name"></span>
                                <button class="remove-file" type="button">√ó</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="pdfSchoolInput">School/University (from Airtable):</label>
                        <input type="text" id="pdfSchoolInput" placeholder="e.g., Stanford University">
                    </div>

                    <div class="form-actions">
                        <button id="extractPdfBtn" class="btn btn-primary">Extract & Add Profile</button>
                        <button id="clearPdfFormBtn" class="btn btn-secondary">Clear Form</button>
                    </div>
                </div>

                <div id="formStatus" class="status-message"></div>

                <div class="stats">
                    <h3>Progress</h3>
                    <p>Total Profiles Collected: <strong id="totalCount">0</strong> / 700</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Attendees Tab -->
        <div class="tab-content active" id="view">
            <div class="view-panel">
                <h2>Attendee Directory</h2>

                <!-- AI Search -->
                <div class="ai-search-container">
                    <div class="ai-search-header">
                        <div class="ai-icon">‚ú®</div>
                        <input type="text" id="aiSearchInput" placeholder="Ask AI: 'Find students interested in national security' or 'Who has experience at startups?'" class="ai-search-input">
                        <select id="modelSelect" class="model-select">
                            <option value="gemini-3-flash">Gemini 3 Flash (Recommended)</option>
                            <option value="gemini-3-pro">Gemini 3 Pro (Best Multimodal)</option>
                            <option value="claude-sonnet">Claude Sonnet (Best Reasoning)</option>
                        </select>
                        <button id="aiSearchBtn" class="btn btn-primary">Search</button>
                        <button id="clearSearchBtn" class="btn btn-secondary" style="display: none;">Clear Results</button>
                    </div>
                    <div class="model-info">
                        <div class="model-details" id="modelDetails">
                            <span class="model-detail-item"><strong>Quality:</strong> <span id="modelQuality">‚≠ê‚≠ê‚≠ê‚≠ê Very Good</span></span>
                            <span class="model-detail-item"><strong>Cost:</strong> <span id="modelCost">~$0.56 per 10 searches</span></span>
                            <span class="model-detail-item"><strong>Speed:</strong> <span id="modelSpeed">Medium (3-5s)</span></span>
                        </div>
                    </div>
                    <div id="aiSearchStatus" class="ai-search-status"></div>
                    <div id="aiSearchResults" class="ai-search-results"></div>
                </div>

                <div class="divider">
                    <span>or use traditional filters</span>
                </div>

                <div class="filters">
                    <div class="filter-group">
                        <input type="text" id="searchInput" placeholder="Search by name, company, school..." class="search-input">
                    </div>

                    <div class="filter-group">
                        <label for="schoolFilter">Filter by School:</label>
                        <select id="schoolFilter">
                            <option value="">All Schools</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="sortBy">Sort by:</label>
                        <select id="sortBy">
                            <option value="name">Name (A-Z)</option>
                            <option value="school">School</option>
                            <option value="recent">Recently Added</option>
                        </select>
                    </div>

                    <button id="clearFiltersBtn" class="btn btn-secondary">Clear Filters</button>
                </div>

                <div id="attendeesList" class="attendees-list">
                    <!-- Attendee cards will be dynamically inserted here -->
                </div>

                <div id="noResults" class="no-results" style="display: none;">
                    No attendees found matching your filters.
                </div>
            </div>
        </div>

        <!-- Import/Export Tab -->
        <div class="tab-content" id="import">
            <div class="import-export-panel">
                <h2>Settings & Data Management</h2>

                <div class="section">
                    <h3>AI Model Information</h3>
                    <p>API keys are securely stored on the server. Search costs are optimized with prompt caching.</p>

                    <div style="background: #FFF9E6; padding: 16px; border-radius: 8px; margin-top: 16px; border-left: 4px solid #FFB800;">
                        <h4 style="font-size: 0.9375rem; margin-bottom: 8px; color: #1D1D1F;">üìä Cost Estimates</h4>
                        <p style="font-size: 0.8125rem; color: #6E6E73; line-height: 1.5;">
                            All pricing shown below is based on a database of <strong>1,300 profiles</strong> with each profile averaging <strong>300 tokens</strong> (~390,000 total tokens).<br>
                            If your database is larger or smaller, costs will scale proportionally for the first search. Subsequent cached searches remain the same price.
                        </p>
                    </div>

                    <div style="background: #F5F5F7; padding: 16px; border-radius: 8px; margin-top: 16px;">
                        <h4 style="font-size: 0.9375rem; margin-bottom: 8px; color: #1D1D1F;">üí° How Caching Works</h4>
                        <p style="font-size: 0.8125rem; color: #6E6E73; line-height: 1.5;">
                            <strong>First search:</strong> Pays full cost to load your entire database into AI memory<br>
                            <strong>Next searches (within cache window):</strong> Database stays in memory, only your new query is processed<br>
                            <strong>After cache expires:</strong> Next search rebuilds cache at full cost<br>
                            <strong>Gemini's advantage:</strong> Cached database is 100% FREE (only query costs), making it cheapest for multiple searches
                        </p>
                    </div>

                    <div style="background: #E8F4F8; padding: 16px; border-radius: 8px; margin-top: 16px; border-left: 4px solid #0071E3;">
                        <h4 style="font-size: 0.9375rem; margin-bottom: 8px; color: #1D1D1F;">ü§ñ Available Models</h4>
                        <div style="font-size: 0.8125rem; color: #6E6E73; line-height: 1.8;">
                            <p><strong>Gemini 3 Flash</strong> (Recommended): First $0.23, Then $0.003 each | Cache: 60min Pro (FREE!)</p>
                            <p><strong>Gemini 3 Pro</strong> (Best Multimodal): First $0.90, Then $0.012 each | Cache: 60min Pro (FREE!)</p>
                            <p><strong>Claude Sonnet</strong> (Best Reasoning): First $1.35, Then $0.14 each | Cache: 5min (90% off)</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>Export Database</h3>
                    <p>Download all collected attendee data as JSON.</p>
                    <button id="exportBtn" class="btn btn-primary">Export to JSON</button>
                </div>

                <div class="section">
                    <h3>Import Database</h3>
                    <p>Upload a previously exported JSON file to restore data.</p>
                    <input type="file" id="importFile" accept=".json">
                    <button id="importBtn" class="btn btn-primary">Import from JSON</button>
                </div>

                <div class="section">
                    <h3>Clear Database</h3>
                    <p class="warning">Warning: This will delete all collected attendee data.</p>
                    <button id="clearDbBtn" class="btn btn-danger">Clear All Data</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js?v=58"></script>
</body>
</html>
